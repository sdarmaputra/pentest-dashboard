import requests
import json


class Client(object):
	def __init__(self, primaryUrl, scenarioId):
		self.primaryUrl = primaryUrl
		self.scenarioId = scenarioId
		self.runnerUrl = self.primaryUrl + "/runner/run/" + str(self.scenarioId)
	
	def runScanner(self):
		req = requests.post(self.runnerUrl)
		runningStatus = json.loads(req.text)
		self.runningStatus = runningStatus
		self.resultUrl = self.primaryUrl + "/result/scenario/" + str(self.scenarioId) + "/" + self.runningStatus['token']
		return runningStatus

	def getRunningStatus(self):
		return self.runningStatus

	def getResults(self):
		req = requests.get(self.resultUrl)
		
		if (req.text != "null"):
			resultData = json.loads(req.text)
			resultDetail = json.loads(resultData['detail'])
			self.resultDetail = resultDetail

			return resultDetail
		else:
			self.resultDetail = []
			return req.text