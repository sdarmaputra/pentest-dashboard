var path = require('path');
var fs = require('fs');
socket = '';

/* Declaration of global variables */
config = [];
config.site_name = 'Pentest Dashboard';
config.app_modules_dirname = path.join(__dirname, '../app_modules');
config.penetration_modules_dirname = path.join(__dirname, '../penetration_modules');
config.base_views_dirname = path.join(__dirname, '../base_views');
config.base_partial_views_dirname = path.join(__dirname, '../base_views');
config.base_layout_dirname = '../base_views/layouts';
config.front_end_modules_dirname = path.join(__dirname, '../front_end_modules');

config.secret = "s4mb4lik4nped4m4nt4psek4li";


/* Loader Functions */
loadModel = function (moduleName) {
  var model;
  fs.readdirSync(path.join(config.app_modules_dirname, moduleName, 'model')).forEach(function(file){
    model = require(path.join(config.app_modules_dirname, moduleName, 'model', file));
  });
  return model;
}

loadConfig = function (configName) {
  var config;
  config = require(path.join(__dirname, configName));
  return config;
}

loadPenetrationModule = function(moduleName) {
  var file;
  file = require(path.join(config.penetration_modules_dirname, moduleName));
  return file;
}

arrayToObject = function(array) {
  var newObject = {};
  array.forEach(function(value, index){
    newObject[index] = value;
  });
  return newObject;
}

// cookie check for front end module
checkJwt = function(req, res, next) {
  console.log(req.cookies);
  if (req.cookies.jwt == undefined || req.cookies.jwt == undefined) {
    res.redirect('/auth');
  }
  next();
}
